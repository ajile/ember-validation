<h1>Mediators</h1>

<p>Валидаторы вызываются не напрямую из валидируемых объектов, а с помощью медиаторов. Так было сделано по нескольким причинам:</p>
<ol>
	<li>Валидация объектов может быть вызвана произвольно, скажем при изменении условий условий валидации или при потере фокуса элементом</li>
	<li>Такое решение дает нам дополнительную гибкость в обращении с валидаторыми</li>
</ol>

<p>В системе выделяется 2-а основных типа медиаторов:</p>
<ul>
	<li>медиатор на аттрибут объекта</li>
	<li>медиатор на валидатор</li>
</ul>

<p>Это обусловлено тем, что у любого аттрибута может быть <u>более одного</u> валидатора. Например у поля <code>user.age</code> может быть валидатор для проверки заполненности <code>required</code> и проверки на число <code>number</code>. При вызове валидации на объекте вызывается медиатор аттрибута, который по очереди вызывает <code>медиаторы валидаторов</code>, которые в свою очередь делают снепшот объекта и вызывают с ним <u>свой</u> <code>валидатор</code>, передавая ему имя свойства, которое требуется провалидировать и параметры валидации.</p>

<p>Параметры валидации хранятся в самих медиаторах, вернее они становятся свойствами самих медиаторов. Таким образом становится возможным определять и использовать мощный механизм <code>computed</code> полей <code>Ember</code>.</p>

<pre data-src="examples/mediators/declare-object-with-computed.javascript" data-line="17,25,28" class="line-numbers"></pre>

<p>Поскольку медиаторы могут самопроизвольно выполняться, насыщение объекта ошибками исходит путям отстрела событий валидации медиаторыми с передачей списка ошибок в них. Эти ошибки слушаются в валидируемом объекте, который и укладывает их в специальное поле <code>errors</code> объекта. Таким образом ошибки становятся доступными из шаблона. Подробнее об ошибках вы можете почитать {{#link-to "tutorial.errors"}}здесь{{/link-to}}.</p>

<p>Принцип работы медиаторов можно объяснить следующей схемой (<a href="https://www.draw.io/#Dprincipal_scheme.html">исходник</a>)</p>

<img src="/images/principal_scheme.svg" />